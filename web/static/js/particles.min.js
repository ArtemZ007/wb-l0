document.addEventListener('DOMContentLoaded', async function () {
    try {
        // Инициализация частиц на фоне страницы. Убедитесь, что файл particles.json находится в корректном месте.
        await particlesJS.load('particles-js', 'particles.json', function () {
            console.log('callback - Конфигурация particles.js успешно загружена');
        });
    } catch (error) {
        // Логирование ошибки, если конфигурация не может быть загружена.
        console.error('Ошибка при загрузке конфигурации particles.js:', error);
    }

    // Получение формы по её идентификатору.
    const form = document.getElementById('uidForm');
    if (!form) {
        console.error('Форма с идентификатором uidForm не найдена.');
        return; // Прекращение выполнения, если форма не найдена
    }
    const submitButton = form.querySelector('button[type="submit"]');
    if (!submitButton) {
        console.error('Кнопка отправки в форме не найдена.');
        return; // Прекращение выполнения, если кнопка не найдена
    }
    const originalButtonText = submitButton.textContent;

    // Обработчик события отправки формы.
    form.onsubmit = async function (e) {
        e.preventDefault(); // Предотвращение стандартного поведения формы.
        submitButton.textContent = 'Отправка...'; // Индикатор загрузки
        submitButton.disabled = true; // Отключение кнопки на время отправки

        // Создание объекта FormData из формы.
        const formData = new FormData(form);

        try {
            // Отправка данных формы на сервер методом POST.
            const response = await fetch('/', {
                method: 'POST',
                body: formData
            });

            // Обработка ответа от сервера.
            if (response.ok) {
                console.log('Данные формы успешно отправлены.');
                alert('Данные успешно отправлены!');
            } else {
                console.error('Ошибка при отправке данных формы. Статус ответа:', response.status);
                alert('Не удалось отправить данные.');
            }
        } catch (error) {
            // Обработка ошибки при отправке данных.
            console.error('Ошибка при отправке данных формы:', error);
            alert('Произошла ошибка при отправке. Пожалуйста, попробуйте снова.');
        } finally {
            submitButton.textContent = originalButtonText; // Восстановление текста кнопки
            submitButton.disabled = false; // Включение кнопки после отправки
        }
    };
});
